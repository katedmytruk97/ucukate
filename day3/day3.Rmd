---
title: "R: Basic conceps "
output: html_document
---


### Змінні (аналог комірки в таблиці Excel)
Для того, щоб зберігати результат підрахунків або дані на різних етапах програми, використовують змінні. Створити змінну та надати їй якесь значення можна за допомогою
оператора "<-"



```{r}
# створюємо вектор із низкою числових значень, і присвоюєм його змінній 
price_in_hryvnya <- c(200, 300, 400, 5000, 1)  # тепер в price_in_hryvnya міститься 5 чисел
currency_ratio <- 28 # тут значення змінної дорівнює 28
price_in_usd <- price_in_hryvnya / currency_ratio  # векторизація! оператор поділити ("/") застосовується одразу до всіх елементів вектору!
price_in_usd
```

### Найпростіші Типи даних у R

```{r}
# ціле число
int_var <- 1
# число з плаваючою точкою
double_var <- 1.25
# строки
char_var <- "це є строка"
# логічні значення
logic_var <- TRUE # or FALSE
# відсутність значення:
na_var <- NA
# перевірка на тип, функції починаються на "is."
is.integer(1) # TRUE
is.double(1) # FALSE
is.na(12.3) # FALSE, це важлива функція, дивитися чи є значення взагалі
# зведення до якогось типу, функції починаються на "as."
# наприклад, to integer:
as.integer(2.34) # результат = 2
as.double("1.2") # з строки створили число з плаваючою точкою
```



### Базовий елемент даних в R - вектор

```{r}
v <-  c(1.2, 34.5, 13.1) # функція c() створює вектор
v + 1:30
v <- c(1:100)
# як отримати 51й елемент вектора, треба дати в [] його індекс: [51]
v[51] # 51th element of vector
v[11:20] # елементи вектора від 11-го до 20-го 
v[c(1, 5, 25)] # індекси також можуть бути вектором, напр. c(1, 5, 25) 
# вектори із строками
text_vector <- c("one", "two", "three")
text_vector[1]
paste(text_vector, "number", " ")
```



### Списки. Створюються за допомогою функції list()

```{r}
l1 <- list(a = 1, b = 2, c = 3)
l1[1] # 1й елемент списку,з іменем "a"
l1$a # значення, що міститься в елементі списку, з іменем "a" (тобто, це 1)
```


### Data frame (аналог таблиці з даними)



```{r}
name <- c("Ira", "Vlad", "Tonya") # перша колонка
age <- c(22, 21, 20)              # друга колонка
gender <- c("F", "M", "F")        # третя колонка
df <- data.frame(name, age, gender) # вся таблиця
write.csv(df,"groupmates.csv", sep = ";") # збережемо у файл, так
#write_csv(df, "groupmates_new.csv", )
write_excel_csv(df, "groupmates_new.csv", delim = ";") # або так
```


### Цикли (Loops)
Якщо потрібно зробити якусь дію декілька разів, використовуємо цикли

```{r}
# надрукуємо "one", "two", "three"
for(i in c("one", "two", "three")){
  print(i)
}
```

### if-else  - умовні переходи (як буде розвиватися логіка програми)
В залежності від істиності умови, виконуємо або один, або інший шматок коду

```{r}
  b <- 1.3
  if(b > 2){ # якби b було більшк 2, виконувати фрагмент коду, що в {}
    print("The number is too big")
  } else { # інакше  виконувати цей код 
    print("The number is too small")
  }
```


### Домашнє завдання,  №1

```{r}
vvv <- c("1.1", "2.2", "3.3", "4.4", "5.5")  # вектор із строками. це строки а не числа, тому що в лапках!
vvv[1] + vvv[2] # помилка, тому що строки не розуміють оператора "+"
# Task 1.1: перетворити кожен елемент vvv в число, "double", за допомогою цикла for
# пройтись по всім елементам вектора vvv. підказка:
# 1. for (e in vvv){ ... } # проходить по всім елементам vvv
# 2. створити новий вектор fff, fff <- vector()
# 3. присвоїти кожному елементу fff відповідний елемент vvv, але перетворений з строки на число (функція для цього є вище в тексті), в тілі цикла це можна зробити за допомогою функції append()
# Task 1.2 Згадайте про векторизацію у R, тобто попередню задачу можна зробити в одну строку
# Task 1.3 Перевірте, що тепер елементи fff можна додавати між собою
```

```{r}
vvv <- c("1.1", "2.2", "3.3", "4.4", "5.5")

# Task 1.1
fff <- c()
for(e in vvv) {
  append(fff, as.double(e), after = length(fff))
}

# Task 1.2
fff <- as.double(vvv)

# Task 1.3
a <- fff[1] + fff[2]
```

Виконання домашки від викладача
```{r}
vvv <- c("1.1", "2.2", "3.3", "4.4", "5.5")
vvv_number <- vector()
i <- 1
for(e in vvv) {
  vvv_number[i] <- as.double(e)
  i <- i + 1
}

vvv3 <- vector()
for(e in vvv) {
  vvv3 <- append(vvv3, as.double(e))
}

```

Виконання домашки дня 4 від викладача
```{r}
library(dplyr)
df <- declarations_source

df1 <- df %>%
  mutate(total_area = flat_area + flat_area_family + house_area + house_area_family)

df2 <- df1 %>%
  mutate(total_income = income + income_family)

```
#2
```{r}
df2 <- df1 %>%
  mutate(total_income = income + income_family)
```

#3
```{r}

df3 <- df2 %>%
  filter(total_area > 100, total_income > 1000000)
```

#4
```{r}
df4 <- df3 %>%
  arrange(desc(total_income) )
```

#5
```{r}
df5 <- df4 %>% 
  select(full_name, total_area, total_income)
```

#6
```{r}
df_new <- df %>%
  mutate(total_area = flat_area + flat_area_family + house_area + house_area_family) %>%
  mutate(total_income = income + income_family) %>%
  filter(total_area > 100, total_income > 1000000) %>%
  arrange(desc(total_income) ) %>% 
  select(full_name, total_area, total_income)
```



